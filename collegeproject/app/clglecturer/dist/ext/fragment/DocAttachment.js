sap.ui.define(["sap/m/MessageToast","sap/m/library","sap/ui/core/mvc/Controller","sap/ui/core/Item","sap/ui/model/json/JSONModel","sap/m/upload/Uploader","sap/ui/core/routing/HashChanger","sap/fe/core/ExtensionAPI"],function(e,t,o,r,s,n,a,i){"use strict";var l=this;var c;return{onInit:function(){},onPress:function(t){e.show("Custom handler invoked.")},onAfterItemAdded:function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.getParameter("item");var r=window.location.href;var s=/College\([^)]*\)/;const n=r.match(s);if(n){c=n[0];console.log(c)}else{console.log("Number not found in URL")}var o=e.getParameter("item");var a={mediaType:o.getMediaType(),fileName:o.getFileName(),size:o.getFileObject().size};var i={url:t+c+"/clgToFile",method:"POST",headers:{"Content-type":"application/json"},data:JSON.stringify(a)};return new Promise((e,t)=>{$.ajax(i).done((t,o,r)=>{e(t.ID)}).fail(e=>{t(e)})}).then(e=>{debugger;var r=t+`Files(ID=${e},IsActiveEntity=false)/content`;o.setUploadUrl(r);var s=this.byId("uploadSet");s.setHttpRequestMethod("PUT");s.uploadItem(o)}).catch(e=>{console.log(e)})},onUploadCompleted:function(e){debugger;var t=this.byId("uploadSet");t.removeAllIncompleteItems();t.getBinding("items");var o=e.oSource.mBindingInfos.items.binding.oContext;o.refresh()},onOpenPressed:async function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.oSource.mProperties.url;let r;if(!o.startsWith(t)){r=t+e.oSource.mProperties.url}else{r=e.oSource.mProperties.url}const s=window.location.href;console.log("Current URL:",s);const n=new URL(s);const a=n.hash.substring(1);const i=/College\(lectId='([^']*)',IsActiveEntity=(true|false)\)/.exec(a);const l=i?i[2]==="true":null;if(l===false){debugger;e.oSource.mProperties.url=r.replace("true","false")}else{e.oSource.mProperties.url=r}},onAfterItemRemoved:function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.getParameter("item");var r=o.getBindingContext().getProperty("ID");var s=t+`Files(ID=${r},IsActiveEntity=false)`;$.ajax({url:s,method:"DELETE",success:function(){sap.m.MessageToast.show("File deleted successfully")}.bind(this),error:function(e){sap.m.MessageToast.show("Error deleting file");console.log("Error deleting file:",e)}})},onFileRenamed:function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.getParameter("item");var r=o.getBindingContext().getProperty("ID");var s=t+`Files(ID=${r},IsActiveEntity=false)`;var n={fileName:sNewFileName};$.ajax({url:s,method:"PATCH",contentType:"application/json",data:JSON.stringify(n),success:function(){sap.m.MessageToast.show("File name updated successfully")},error:function(e){sap.m.MessageToast.show("Error updating file name");console.log("Error updating file name:",e)}})}}});
//# sourceMappingURL=DocAttachment.js.map